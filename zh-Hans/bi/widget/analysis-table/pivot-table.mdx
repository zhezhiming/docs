---
title: 数据透视表
sidebar_position: 2
---

数据透视表是行列交叉地对多维数据进行展示的表格方式.

### 数据配置

除通用数据配置外, 数据透视表的数据配置有以下特点:

* 行或者列中添加维度后, 设置维度的属性 **包含父级层级** 表格将此维度展示为树状层次结构.
* 为此维度选择层次结构和层级后, 表格将在初始化时加载从根节点至此层级的成员数据.
* 点击成员展开按钮, 未加载的成员将远程异步加载进来(TODO: 此功能待开发).
* 列上设置树状展示需要设置给首个维度.
* 列上最大可设置 **3** 个维度.
* 行上维度个数无限制.
* 行上将首个设置了包含父级层级的维度作为树状结构展示.
* 行数最大只展示一个树状结构.

![](./pivot-grid.png)

### 表格配置

数据透视表格除了 [通用的表格配置](../#表格配置) 外还有以下数据透视相关的设置:

| 属性         | 英文                   | 描述                           |
| ------------ | ---------------------- | ------------------------------ |
| 行初始层级   | **Row Initial Level**       | 行数据树型结构的初始化时的层级深度   |
| 列初始层级   | **Column Initial Level**       | 列数据树型结构的初始化时的层级深度   |

### 样式

除了下方的通用故事组件样式设置外, 上方是表格特有外观配置:

* **显示密度**: 
* 组件其他 CSS 样式

## 指标在表格中的应用

表格的行或者列中除了可以配置维度和度量外, 指标管理功能中创建的指标也可以应用在表格中.

指标本身会在度量的基础上对模型的部分维度进行限定, 将剩余维度不作限定即作为自由维度. 指标的自由维度会在其所处的运行时上下文中进行限定, 这样就达到了对模型所有维度的限定.
当然指标中的维度和运行时上下文中的维度可能会有重叠, 那么指标的度量值以指标本身的维度限定为准, 不受上下文中的重叠维度影响.

当指标处在表格中时, 指标的自由维度将由行和列上的维度进行限定, 还可能会有来自于故事上其他输入控制组件过滤器值对维度进行限定.

![](./pivot-grid-indicators.png)

创建过程

* 指标和度量一样进行选择.

## 表格与输入控制器组合使用

上面指标和表格的维度限定中提到还可以使用输入控制器来限定模型的维度, 即当有些维度想要让用户自行选择的情况, 可以通过为这样的维度创建输入控制器组件来做到.

如下图所示, 将 **产品** 维度作为灵活的选择控制器, 让用户自行选择需要分析的产品数据.

![](./analytical-grid-input-control.png)

## 示例

<iframe src="https://app.mtda.cloud/public/story/widget/3b7b9347-9713-496a-aa94-a877b3553948" width="100%" height="500px" frameBorder="0" scrolling="no" allowFullScreen></iframe>

<iframe src="https://app.mtda.cloud/public/story/widget/82cd416b-0ef9-4210-b33b-2ea6c7ac2d07" width="100%" height="500px" frameBorder="0" scrolling="no" allowFullScreen></iframe>
