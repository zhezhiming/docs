---
sidebar_position: 11
title: Schema UI æ‰©å±•è§„èŒƒ
---

:::tip
è®¾è®¡ä¸€å¥— é€šç”¨çš„ schema UI æ‰©å±•è§„èŒƒ
:::

ğŸ‘Œå¥½çš„ï¼Œæˆ‘æ¥å¸®ä½ è®¾è®¡ä¸€å¥— **é€šç”¨çš„ Schema UI æ‰©å±•è§„èŒƒ**ï¼Œå¯ä»¥åº”ç”¨åœ¨ä½ çš„æ’ä»¶ç³»ç»Ÿæ‰€æœ‰é…ç½® schema ä¸­ï¼Œè®©å‰ç«¯æ¸²æŸ“æ—¶æœ‰ç»Ÿä¸€çš„è§„åˆ™ã€‚

---

åœ¨ JSON Schema åŸºç¡€ä¸Šæ‰©å±•ä¸€ä¸ªä¿ç•™å­—æ®µï¼š

```json
"x-ui": { ... }
```

å‰ç«¯ UI æ¸²æŸ“å™¨æ ¹æ® `x-ui` çš„å†…å®¹å†³å®šç”¨ä»€ä¹ˆç»„ä»¶ã€æ€ä¹ˆå±•ç¤ºã€æ€ä¹ˆåŠ¨æ€è”åŠ¨ã€‚

---

## 1. åŸºç¡€å­—æ®µ

| å­—æ®µå            | ç±»å‹     | è¯´æ˜                                                                                                                       |
| -------------- | ------ | ------------------------------------------------------------------------------------------------------------------------ |
| `component`    | string | æŒ‡å®š UI ç»„ä»¶ç±»å‹ï¼Œå¦‚ `textInput`, `textarea`, `select`, `switch`, `slider`, `promptEditor`, `modelProviderSelect`, `modelSelect` |
| `label`        | string | UI å±•ç¤ºçš„æ ‡ç­¾                                                                                                                 |
| `description`  | string | UI å±•ç¤ºçš„å¸®åŠ©æ–‡æœ¬ï¼Œä¼˜å…ˆè¦†ç›– schema.description                                                                                       |
| `placeholder`  | string | è¾“å…¥å ä½ç¬¦                                                                                                                    |
| `defaultValue` | any    | é»˜è®¤å€¼ï¼Œä¼˜å…ˆè¦†ç›– schema.default                                                                                                  |
| `order`        | number | å­—æ®µåœ¨ UI ä¸­çš„å±•ç¤ºé¡ºåº                                                                                                            |

---

## 2. æ•°æ®æºç›¸å…³

| å­—æ®µå          | ç±»å‹     | è¯´æ˜                                                         |
| ------------ | ------ | ---------------------------------------------------------- |
| `options`    | array  | é™æ€é€‰é¡¹ï¼ˆä¸‹æ‹‰æ¡†ã€å¤šé€‰æ¡†ç­‰ï¼‰ï¼Œå½¢å¦‚ `[{ label: 'OpenAI', value: 'openai' }]` |
| `dataSource` | string | åŠ¨æ€é€‰é¡¹æ¥æºæ ‡è¯†ï¼Œå¦‚ `"system.providers"`, `"system.models"`         |
| `dependency` | string | ä¾èµ–å…¶ä»–å­—æ®µçš„å€¼æ¥è¿‡æ»¤é€‰é¡¹ï¼Œå¦‚ `"provider"`                               |
| `mapping`    | object | æ˜ å°„å…³ç³»ï¼Œä¾‹å¦‚ `{ label: 'name', value: 'id' }`                   |

---

## 3. éªŒè¯ä¸äº¤äº’

| å­—æ®µå           | ç±»å‹      | è¯´æ˜                                           |
| ------------- | ------- | -------------------------------------------- |
| `required`    | boolean | æ˜¯å¦å¿…å¡«ï¼ˆä¼˜å…ˆè¦†ç›– schema.requiredï¼‰                   |
| `visibleWhen` | object  | æ¡ä»¶æ¸²æŸ“ï¼Œåªæœ‰æ»¡è¶³æ¡ä»¶æ‰æ˜¾ç¤ºå­—æ®µï¼Œä¾‹å¦‚ `{ provider: 'openai' }` |
| `enabledWhen` | object  | æ¡ä»¶å¯ç”¨ï¼Œä¾‹å¦‚ `{ useCustomPrompt: true }`          |
| `maxLength`   | number  | è¾“å…¥æœ€å¤§é•¿åº¦                                       |
| `minLength`   | number  | è¾“å…¥æœ€å°é•¿åº¦                                       |
| `regex`       | string  | è‡ªå®šä¹‰æ­£åˆ™æ ¡éªŒè§„åˆ™                                    |

---

## 4. ç‰¹æ®Šç»„ä»¶çº¦å®š

### `modelProviderSelect`

* ç”¨äºé€‰æ‹©æ¨¡å‹æä¾›å•†ï¼ˆOpenAIã€Anthropicã€Azureã€Ollama ç­‰ï¼‰
* `dataSource = "system.providers"`

### `modelSelect`

* ç”¨äºé€‰æ‹©å…·ä½“æ¨¡å‹
* éœ€è¦ä¾èµ– `provider`
* `dataSource = "system.models"`
* `dependency = "provider"`

### `promptEditor`

* ç”¨äºç¼–è¾‘ Promptï¼Œæ”¯æŒå¤šè¡Œã€è¯­æ³•é«˜äº®ã€å˜é‡æ’å€¼

### `jsonEditor`

* ç”¨äºç¼–è¾‘ JSON å¯¹è±¡ï¼Œå¸¦æ ¼å¼æ ¡éªŒ

### `codeEditor`

* ç”¨äºç¼–è¾‘ä»£ç ï¼ˆæ”¯æŒè¯­è¨€é«˜äº®ï¼Œå¦‚ js, ts, pythonï¼‰

---

## 5. ç¤ºä¾‹ Schema

```ts
configSchema: {
  type: 'object',
  properties: {
    provider: {
      type: 'string',
      description: 'æ¨¡å‹æä¾›å•†',
      enum: ['openai', 'anthropic', 'azure', 'ollama'],
      'x-ui': {
        component: 'modelProviderSelect',
        label: 'Provider',
        order: 1,
        dataSource: 'system.providers'
      }
    },
    model: {
      type: 'string',
      description: 'å¤§æ¨¡å‹åç§°',
      default: 'gpt-4-vision-preview',
      'x-ui': {
        component: 'modelSelect',
        label: 'Model',
        order: 2,
        dependency: 'provider',
        dataSource: 'system.models'
      }
    },
    prompt: {
      type: 'string',
      default: 'Describe this image in detail.',
      description: 'æç¤ºè¯',
      'x-ui': {
        component: 'promptEditor',
        label: 'Prompt',
        order: 3,
        placeholder: 'è¯·è¾“å…¥æç¤ºè¯ï¼Œå¯ä½¿ç”¨ {{variables}} å ä½ç¬¦'
      }
    },
    temperature: {
      type: 'number',
      default: 0.7,
      'x-ui': {
        component: 'slider',
        label: 'Temperature',
        order: 4,
        min: 0,
        max: 1,
        step: 0.1
      }
    },
    advanced: {
      type: 'object',
      'x-ui': {
        component: 'jsonEditor',
        label: 'Advanced Config',
        order: 5,
        visibleWhen: { provider: 'openai' }
      }
    }
  },
  required: ['provider', 'model']
}
```

---

è¿™æ ·ä¸€æ¥ï¼š

* å‰ç«¯ UI æ¸²æŸ“å™¨åªéœ€è¦è¯†åˆ« `x-ui.component`ï¼Œå…¶ä½™é€»è¾‘ç”± `x-ui` å­—æ®µé©±åŠ¨ã€‚
* æ’ä»¶å¼€å‘è€…åªéœ€å†™ schemaï¼Œå°±èƒ½è‡ªåŠ¨è·å¾—æ™ºèƒ½åŒ–é…ç½®ä½“éªŒã€‚
* æ‰©å±•æ€§å¼ºï¼Œå¯ä»¥ç»Ÿä¸€é€‚é…æœªæ¥çš„ Embeddingã€OCRã€VLMã€VectorStore æ’ä»¶ã€‚

## å¦‚ä½•è¡¨ç¤º SECRET çš„input å­—æ®µ

å¥½é—®é¢˜ ğŸ‘ï¼Œ**SECRET ç±»å‹çš„å­—æ®µ**ï¼ˆæ¯”å¦‚ API Keyã€Tokenã€å¯†ç ï¼‰åœ¨ schema UI é‡Œéœ€è¦ç‰¹æ®Šå¤„ç†ï¼š

1. **å‰ç«¯æ¸²æŸ“æ—¶è¦æ˜¾ç¤ºä¸ºå¯†ç è¾“å…¥æ¡†**ï¼ˆ`type="password"` æˆ–é®ç½©ï¼‰ã€‚
2. **å­˜å‚¨æ—¶éœ€è¦åŒºåˆ†**ï¼šä¸å›æ˜¾åŸå§‹å€¼ï¼Œè€Œæ˜¯ç”¨ `"******"` æˆ–ç©ºå€¼å ä½ã€‚
3. **Schema ä¸­å¯ä»¥æ˜¾å¼æ ‡è®°**ï¼Œè®©å‰ç«¯ UI æ¸²æŸ“å™¨çŸ¥é“è¿™æ˜¯ä¸€ä¸ªå¯†é’¥å­—æ®µã€‚

---

## æ‰©å±•è§„èŒƒæ–¹æ¡ˆ

åœ¨ `x-ui` é‡Œå¢åŠ  `component: "secretInput"`ï¼Œå¹¶æ”¯æŒä»¥ä¸‹å±æ€§ï¼š

| å­—æ®µå           | ç±»å‹      | è¯´æ˜                          |
| ------------- | ------- | --------------------------- |
| `component`   | string  | å›ºå®šä¸º `"secretInput"`ï¼Œæ¸²æŸ“å¯†ç è¾“å…¥æ¡† |
| `label`       | string  | å­—æ®µæ ‡ç­¾                        |
| `description` | string  | å­—æ®µè¯´æ˜                        |
| `placeholder` | string  | å ä½ç¬¦ï¼ˆå¦‚ `è¯·è¾“å…¥ API Key`ï¼‰        |
| `revealable`  | boolean | æ˜¯å¦å…è®¸ç”¨æˆ·ç‚¹æŒ‰é’®ä¸´æ—¶æŸ¥çœ‹æ˜æ–‡             |
| `maskSymbol`  | string  | é®ç½©ç¬¦å·ï¼ˆé»˜è®¤ `*`ï¼‰                |
| `persist`     | boolean | æ˜¯å¦æŒä¹…ä¿å­˜ï¼Œfalse æ—¶è¡¨ç¤ºä»…è¿è¡Œæ—¶ä½¿ç”¨ï¼Œä¸è½ç›˜  |

---

## ç¤ºä¾‹ Schema

```ts
configSchema: {
  type: 'object',
  properties: {
    apiKey: {
      type: 'string',
      description: 'OpenAI API Key',
      'x-ui': {
        component: 'secretInput',
        label: 'API Key',
        placeholder: 'è¯·è¾“å…¥æ‚¨çš„ OpenAI API Key',
        revealable: true,
        maskSymbol: '*',
        persist: true
      }
    },
    provider: {
      type: 'string',
      enum: ['openai', 'anthropic', 'azure'],
      'x-ui': {
        component: 'modelProviderSelect',
        label: 'Provider'
      }
    }
  },
  required: ['apiKey', 'provider']
}
```

---

## å‰ç«¯æ¸²æŸ“æ•ˆæœ

* `apiKey` æ˜¾ç¤ºä¸º **å¯†ç è¾“å…¥æ¡†**ï¼Œé»˜è®¤é®ç½©æ˜¾ç¤ºã€‚
* å¦‚æœ `revealable: true`ï¼ŒUI ä¸Šæœ‰ ğŸ‘ æŒ‰é’®ï¼Œç”¨æˆ·å¯åˆ‡æ¢æ˜¾ç¤º/éšè—ã€‚
* ç¼–è¾‘é…ç½®æ—¶ï¼Œå¦‚æœåç«¯è¿”å› `"******"` ä»£è¡¨å·²æœ‰å€¼ï¼Œç”¨æˆ·ä¸æ”¹å°±ç»§ç»­ä½¿ç”¨åŸå€¼ã€‚

---

## é¢å¤–å®‰å…¨è€ƒè™‘

* å‰ç«¯è¡¨å•æäº¤æ—¶ï¼Œå¦‚æœ `apiKey === "******"`ï¼Œè¡¨ç¤ºä¸ä¿®æ”¹ï¼Œåç«¯åº”ä¿ç•™æ—§å€¼ã€‚
* å¦‚æœæäº¤äº†æ–°å€¼ï¼Œåˆ™åç«¯æ›¿æ¢æ—§å€¼ã€‚
* æ—¥å¿—ã€å¯¼å‡ºé…ç½®æ—¶è·³è¿‡ SECRET å­—æ®µã€‚

---

è¦ä¸è¦æˆ‘å¸®ä½ æŠŠ **SECRET å­—æ®µ** å†æŠ½è±¡æˆä¸€ä¸ªé€šç”¨æ¥å£ï¼ˆæ¯”å¦‚ `ISchemaSecretField`ï¼‰ï¼Œè¿™æ ·å’Œæ™®é€šå­—æ®µåŒºåˆ†å¾—æ›´æ¸…æ™°ï¼Ÿ

## æŠ½è±¡æˆä¸€ä¸ªé€šç”¨æ¥å£

ğŸ‘Œå¥½çš„ï¼Œæˆ‘ä»¬æŠŠ **SECRET å­—æ®µ**æŠ½è±¡æˆä¸€ä¸ªé€šç”¨æ¥å£ï¼Œæ—¢èƒ½å’Œæ™®é€šå­—æ®µä¿æŒä¸€è‡´ï¼Œåˆèƒ½æ˜ç¡®æ ‡è¯†â€œè¿™æ˜¯ä¸€ä¸ªéœ€è¦ç‰¹æ®Šå¤„ç†çš„æ•æ„Ÿå­—æ®µâ€ã€‚

---

# ğŸ” é€šç”¨æ¥å£è®¾è®¡

```ts
/**
 * é€šç”¨ UI Schema å­—æ®µå®šä¹‰
 */
export interface ISchemaUIBase {
  component: string;       // UI ç»„ä»¶ç±»å‹
  label?: string;          // å­—æ®µæ ‡ç­¾
  description?: string;    // å­—æ®µè¯´æ˜
  placeholder?: string;    // è¾“å…¥å ä½ç¬¦
  order?: number;          // UI æ˜¾ç¤ºé¡ºåº
  required?: boolean;      // æ˜¯å¦å¿…å¡«
  visibleWhen?: Record<string, any>; // æ¡ä»¶æ¸²æŸ“
  enabledWhen?: Record<string, any>; // æ¡ä»¶å¯ç”¨
}

/**
 * Secret å­—æ®µæ‰©å±•
 */
export interface ISchemaSecretField extends ISchemaUIBase {
  component: 'secretInput';   // å›ºå®šç»„ä»¶ç±»å‹
  revealable?: boolean;       // æ˜¯å¦å…è®¸æ˜æ–‡æ˜¾ç¤ºï¼ˆğŸ‘ æŒ‰é’®ï¼‰
  maskSymbol?: string;        // é®ç½©ç¬¦å·ï¼ˆé»˜è®¤ *ï¼‰
  persist?: boolean;          // æ˜¯å¦æŒä¹…ä¿å­˜ï¼Œfalse è¡¨ç¤ºä»…è¿è¡Œæ—¶ä½¿ç”¨
}
```

è¿™æ · SECRET å­—æ®µå°±å’Œæ™®é€š UI å­—æ®µç»§æ‰¿åŒä¸€å¥—è§„èŒƒï¼Œåªæ˜¯ **å¤šäº†ä¸€äº›æ•æ„Ÿä¿¡æ¯å¤„ç†çš„æ‰©å±•å±æ€§**ã€‚

---

# ğŸ”§ ä½¿ç”¨ç¤ºä¾‹

```ts
configSchema: {
  type: 'object',
  properties: {
    apiKey: {
      type: 'string',
      description: 'OpenAI API Key',
      'x-ui': <ISchemaSecretField>{
        component: 'secretInput',
        label: 'API Key',
        placeholder: 'è¯·è¾“å…¥æ‚¨çš„ OpenAI API Key',
        revealable: true,
        maskSymbol: '*',
        persist: true
      }
    },
    provider: {
      type: 'string',
      enum: ['openai', 'anthropic', 'azure'],
      'x-ui': {
        component: 'modelProviderSelect',
        label: 'Provider'
      }
    }
  },
  required: ['apiKey', 'provider']
}
```

---

# ğŸ”’ å‰ç«¯å¤„ç†è§„èŒƒ

1. **æ¸²æŸ“æ—¶**ï¼š

   * `secretInput` æ¸²æŸ“ä¸ºå¯†ç æ¡†ï¼ˆ`type=password`ï¼‰ã€‚
   * å¦‚æœ `revealable: true`ï¼Œå¢åŠ  ğŸ‘ åˆ‡æ¢æŒ‰é’®ã€‚

2. **åŠ è½½é…ç½®æ—¶**ï¼š

   * åç«¯è¿”å› `******` ä»£è¡¨å·²æœ‰å€¼ï¼Œå‰ç«¯ä¸å±•ç¤ºçœŸå®å†…å®¹ã€‚

3. **ä¿å­˜é…ç½®æ—¶**ï¼š

   * å¦‚æœæäº¤çš„å€¼ä»ä¸º `******` â†’ ä¿æŒæ—§å€¼ä¸å˜ã€‚
   * å¦‚æœæäº¤äº†æ–°å€¼ â†’ æ›´æ–°å­˜å‚¨å¹¶è¦†ç›–æ—§å€¼ã€‚

4. **å¯¼å‡ºé…ç½®/æ—¥å¿—**ï¼š

   * å¿½ç•¥ SECRET å­—æ®µæˆ–è¾“å‡º `******`ï¼Œé¿å…æ³„éœ²ã€‚

---

è¿™æ ·ä»¥å `secretInput` å°±æ˜¯ä¸€ä¸ª **ä¸€çº§å…¬æ°‘ UI ç»„ä»¶**ï¼Œå’Œ `textInput`ã€`select` ä¸€æ ·å¯ä»¥è¢« schema ç»Ÿä¸€é©±åŠ¨ã€‚

è¦ä¸è¦æˆ‘å†å¸®ä½ å®šä¹‰ä¸€ä¸ª **å®Œæ•´çš„ ISchemaUIComponent è”åˆç±»å‹**ï¼ŒæŠŠæ‰€æœ‰ `x-ui` ç»„ä»¶ï¼ˆselectã€sliderã€secretInputã€promptEditor ç­‰ï¼‰éƒ½è§„èŒƒèµ·æ¥ï¼Ÿ
