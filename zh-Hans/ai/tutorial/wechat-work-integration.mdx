---
title: 企业微信集成
sidebar_position: 2
tags:
  - Workflow
  - Agent
---

Xpert AI 多智能体平台已支持**企业微信**集成功能。通过本集成，企业用户可直接在企业微信中调用数字专家的智能对话能力，包括使用 **ChatBI 工具集**进行数据分析，并以截图形式返回分析结果。

本教程将一步步指导您完成企业微信集成配置。

---

## 第一步：创建企业微信应用并获取必要信息

1. 登录 [企业微信管理后台](https://work.weixin.qq.com/)，进入**“应用管理”**。
2. 点击“自建应用”，创建一个新的应用，填写应用名称、logo、简介等信息。
3. 创建成功后，记录以下信息：
   - **AgentId**
   - **Secret**

4. 继续在该应用的设置页面中，启用并打开**接收消息**功能，设置 Token 和 EncodingAESKey，平台会返回如下信息：
   - **Token**
   - **EncodingAESKey**

5. 最后，前往“**我的企业**”页面，获取企业唯一标识：
   - **企业ID（CorpID）**

✅ 至此，你已经获得了以下五项重要信息：

- 企业ID（CorpID）  
- AgentId  
- Secret  
- Token  
- EncodingAESKey

---

## 第二步：配置数字专家与企业微信集成

1. 登录 Xpert AI 平台，前往“**数字专家**”模块，创建一个新的数字专家智能体。
2. 在配置工具集时，若该智能体用于数据分析，**请选择工具集类型为 “与企业微信对话 BI”**，以启用 ChatBI 分析能力。
3. 完成智能体配置后，点击“发布版本”，并在**发布到第三方平台**步骤中添加“企业微信”发布渠道。
4. 填写刚才在企业微信管理后台中获取的五项信息：

   - 企业ID（CorpID）  
   - AgentId  
   - Secret  
   - Token  
   - EncodingAESKey  

5. 保存配置后，系统将生成一个回调地址（Callback URL）。

---

## 第三步：将回调地址填入企业微信以完成验证

1. 返回企业微信管理后台，打开该应用的“接收消息”设置。
2. 将 Xpert AI 提供的 **Callback URL** 填入 **“接收消息服务器地址”** 字段中。
3. 点击保存，平台会自动发起验证请求。
4. 若配置无误，即可看到验证成功提示。

🎉 恭喜你，数字专家智能体已成功接入企业微信！

---

## 第四步：在企业微信中对话数字专家

现在，企业微信的用户就可以：

- 直接与 Xpert AI 智能体对话
- 使用 ChatBI 进行 BI 数据分析
- 收到以截图形式返回的分析图表和结论

---

## 常见问题（FAQ）

在将 Xpert AI 数字专家集成到企业微信的过程中，您可能会遇到一些常见问题，以下是问题汇总与对应的解决建议：

### 1. 配置完成后，发送消息给企业微信应用没有任何回应

**可能原因及解决方法：**

- 应用未开启“接收消息”功能  
  👉 请在企业微信管理后台，确保“接收消息”功能已启用。

- 回调地址未正确填写或验证未通过  
  👉 请确认 Callback URL 填写无误，且平台验证成功。

- AgentId 填错或 Secret 配置错误  
  👉 检查在 Xpert AI 平台中填写的 AgentId 和 Secret 是否与企业微信一致。

- 企业微信应用的企业可信IP
  👉 检查企业可信IP是否配置了服务器出口 IP （XpertAI 在线系统的 IP 可以联系我们的技术人员获取）
---

### 2. ChatBI 分析请求失败，或收不到截图返回

**可能原因及解决方法：**

- 智能体未启用“与企业微信对话 BI”工具集
  👉 请检查智能体工具集中是否正确选择了“与企业微信对话 BI”。

- 分析结果生成失败或截图服务异常  
  👉 请联系平台管理员，查看日志是否存在异常。

---

### 3. 企业微信提示“URL验证失败”

**可能原因及解决方法：**

- Token 或 EncodingAESKey 填写错误  
  👉 请与企业微信设置页面中的内容严格一致。

- 回调地址无法从公网访问  
  👉 请确保服务器部署在公网可访问的地址，且端口放通。

- 企业微信服务器请求被防火墙或代理拦截  
  👉 检查是否有安全组、WAF 等拦截企业微信的请求。

---

### 4. 企业微信应用用户无法看到该应用或入口

**可能原因及解决方法：**

- 应用可见范围未设置  
  👉 请到企业微信应用设置中，添加用户、部门等，使其有权限访问该应用。

---

如需进一步了解 ChatBI 功能或企业定制化需求，欢迎联系我们的产品支持团队！
